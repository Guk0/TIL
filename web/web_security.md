## SQL Injection
클라이언트의 입력값에 임의의 SQL 문을 넣어 서버의 데이터베이스를 공격할 수 있는 공격방식을 말합니다. 주로 사용자가 입력한 데이터를 제대로 필터링, 이스케이핑하지 못했을 경우에 발생한다

<br>

[xss](https://lucete1230-cyberpolice.tistory.com/23)  
[reflect xss](https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=dmbs335&logNo=10173704381)

## XSS
크로스 사이트 스크립팅은 악의적인 사용자가 공격하려는 사이트에 스크립트를 넣는 기법을 말한다. 이 취약점은 웹 애플리케이션이 사용자로부터 입력 받은 값을 제대로 검사하지 않고 사용할 경우 나타나며, 공격에 성공하면 사이트에 접속한 사용자는 삽입된 코드를 실행하게 된다. 보통 의도치 않은 행동을 수행시키거나 쿠키나 세션 토큰 등의 민감한 정보를 탈취한다.

### Stored XSS와 Reflected XSS
Stored XSS

사용자가 게시물을 열람시, 공격자가 입력(db에 저장된)해놓은 악성 스크립트가 실행되어 사용자의 쿠키 정보가 유출되거나, 악성 스크립트가 기획한 공격에 당하게 된다.

<br>

Reflected XSS

URL의 변수 부분처럼 스크립트 코드를 입력하는 동시에 결과가 바로 전해지는 공격기법이다.
사용자가 입력한 파라미터가 화면에 그려지는 경우에 공격이 가능하다.
스크립트를 통해 redirect시키거나 쿠키 정보를 탈취할 수 있다.

<br>

## CSRF
[참조](https://junhyunny.github.io/information/security/spring-boot/spring-security/cross-site-reqeust-forgery/)

CSRF(Cross-Site Request Forgery) - 사이트 간 요청 위조  
사용자가 자신의 의지와는 무관하게 공격자가 의도한 행위(수정, 삭제, 등록 등)를 특정 웹사이트에 요청하게 하는 공격을 말한다.

### CSRF의 공격 과정
조건
- 사용자가 보안이 취약한 서버로부터 이미 인증을 받은 상태여야 합니다.
- 쿠키 기반으로 서버 세션 정보를 획득할 수 있어야 합니다.
- 공격자는 서버를 공격하기 위한 요청 방법에 대해 미리 파악하고 있어야 합니다. 예상치 못한 파라미터가 있으면 불가능합니다.

과정
1. 사용자는 보안이 취약한 서버에 로그인합니다.
2. 로그인 이후 서버에 저장된 세션 정보를 사용할 수 있는 `sessionID`가 사용자 브라우저 쿠키에 저장됩니다.
3. 공격자는 서버에 인증된 브라우저의 사용자가 악성 스크립트 페이지를 누르도록 유도합니다.
    - 해당 악성 스크립트가 담긴 페이지를 클릭하도록 유도하는 방법은 다양한 것 같으나 몇 가지 유형을 정리하자면 다음과 같습니다.
    - 게시판에 악성 스크립트를 게시글로 작성하여 관리자 혹은 다른 사용자들이 게시글을 클릭하도록 유도합니다.
    - 메일 등으로 악성 스크립트를 직접 전달하거나, 악성 스크립트가 적힌 페이지 링크를 전달합니다.
4. 사용자가 악성 스크립트가 작성된 페이지 접근시 쿠키에 저장된 `sessionID`는 브라우저에 의해 자동적으로 함께 서버로 요청됩니다.
5. 서버는 쿠키에 담긴 `sessionID`를 통해 해당 요청이 인증된 사용자로부터 온 것으로 판단하고 처리합니다.

<br>


## 방지 대책
XSS의 방지 대책
1. 쿠키에 중요한 정보를 담지 않고 서버에 중요정보를 저장하는 방법
2. 정보를 암호화 하는 방법
3. httponly 속성 on(자바스크립트의 document.cookie를 이용해서 쿠키에 접속하는 것을 막는 옵션으로, 쿠키를 훔쳐가는 행위를 막기 위한 방법이다.)
4. html escaping을 한다.


CSRF의 방지 대책
1. Referrer 검증(Back -end 단에서 request 의 referrer을 확인하여 domain이 일치하는지 검증하는 방법)
2. Security Token 사용
  - Reffer검증이 불가한 환경일 시, Security Token을 활용한다.사용자 세션에 임의의 난수 값을 저장하고, 사용자의 요청마다 해당 난수 값을 포함 시켜 전송한다.
  - 이후 Back -end 단에서 요청을 받을 떄마다 세션에 저장된 토큰 값과 요청 파라미터에 전달되는 토큰 값이 일치한지 검증하는 방법
  
두 방법 모두 같은 도메인 내에 XSS취약점이 있다면 CSRF 공격에 취약 해질 수 있다

